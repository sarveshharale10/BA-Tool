{% extends "layout.html" %}

{% block content %}
      <section class="wrapper">
          <h2 class="">
              Track
          </h2>
<!-- INLINE FORM ELELEMNTS -->
<div class="row mt">
    <div class="col-lg-12">
        <div class="form-panel">
            <h4 class="mb"><i class="fa fa-angle-right"></i> Track </h4>
            <form id="graph" class="form-inline" role="form">
                <div class="form-group">
                    <label class="sr-only" for="exampleInputEmail2">Address</label>
                    <input type="text" class="form-control" id="address" placeholder="Enter Address">
                </div>
                <div class="form-group">
                    <label class="sr-only" for="exampleInputPassword2">Hop Count</label>
                    <input type="text" class="form-control" id="hop_count" placeholder="Enter Hop Count">
                </div>
                <button type="submit" class="btn btn-theme"> Generate Graph </button>
            </form>
        </div>
        <!-- /form-panel -->
    </div>
    <!-- /col-lg-12 -->
    <div id="neo4jd3"></div>
    <!-- Scripts -->
    <script src="static/js/d3.min.js"></script>
    <script src="static/js/neo4jd3.js?v=0.0.1"></script>
    <script src="static/js/jquery.js"></script>
    <script type='text/javascript'>
        /* attach a submit handler to the form */
        $("#graph").submit(function (event) {

            /* stop form from submitting normally */
            event.preventDefault();

            /* get the action attribute from the <form action=""> element */
            var form = $(this), url = '/track';

            /* Send the data using post with element id name and name2*/
            var posting = $.post(url, { address: $('#address').val(), hop_count: $('#hop_count').val()});
            alert('Sending request');
            /* Alerts the results */
            posting.done(function (result) {
                alert('success');
                console.log(result);
                data = {
                    "results": [{
                        "data": [{ "graph": result }]
                    }],
                    "errors": []
                }
                var neo4jd3 = new Neo4jd3('#neo4jd3', {
                    minCollision: 60,
                    neo4jData: data,
                    nodeRadius: 25,
                    zoomFit: false
                });
            });
        });

        function get_data() {
            tx_hash = $("#tx_hash").val();
            $.ajax({
                method: "POST",
                url: "/transaction",

                success: function (result) {
                    data = {
                        "results": [{
                            "data": [{ "graph": result }]
                        }],
                        "errors": []
                    }
                    var neo4jd3 = new Neo4jd3('#neo4jd3', {
                        minCollision: 60,
                        neo4jData: data,
                        nodeRadius: 25,
                        zoomFit: false
                    });
                }
            });
        }
    </script>
</div>
<!-- /row -->

</section>
{% endblock content %}
{% block scripts %}
{% endblock scripts %}