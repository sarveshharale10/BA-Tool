{% extends "layout.html" %}

{% block content %}
    <div class="row mt">
        <div class="col-lg-12">
            <div class="form-panel">
                <h4 class="mb"><i class="fa fa-angle-right"></i> Trace </h4>
                <form id="graph" class="form-inline" role="form">
                    <div class="form-group">
                        <label class="sr-only" for="exampleInputEmail2">Address</label>
                        <input type="text" class="form-control" id="address" placeholder="Enter Address">
                    </div>
                    <div class="form-group">
                        <label class="sr-only" for="exampleInputPassword2">Hop Count</label>
                        <input type="text" class="form-control" id="hop_count" placeholder="Enter Hop Count">
                    </div>
                    <button type="submit" class="btn btn-theme"> Generate Graph </button>
                </form>
            </div>
            <!-- /form-panel -->
        </div>
    </div>
        <div id="neo4jd3" style="height:100%; width:100%;"></div>
        <!-- Scripts -->
        <script src="static/js/d3.min.js"></script>
        <script src="static/js/neo4jd3.js?v=0.0.1"></script>
        <script src="static/js/jquery.js"></script>
        <script type='text/javascript'>
            /* attach a submit handler to the form */
            $("#graph").submit(function (event) {

                /* stop form from submitting normally */
                event.preventDefault();

                url = '/trace';

                var posting = $.post(url, { address: $('#address').val(), hop_count: $('#hop_count').val()});
                /* Alerts the results */
                posting.done(function (result) {
                    data = {
                        "results": [{
                            "data": [{ "graph": result }]
                        }],
                        "errors": []
                    }
                    var neo4jd3 = new Neo4jd3('#neo4jd3', {
                        minCollision: 60,
                        neo4jData: data,
                        nodeRadius: 25,
                        zoomFit: false
                    });
                });
            });

        </script>
{% endblock content %}
{% block scripts %}
{% endblock scripts %}